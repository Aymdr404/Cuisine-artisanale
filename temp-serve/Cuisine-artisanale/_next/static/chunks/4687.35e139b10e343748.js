(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4687],{2737:()=>{},3769:(e,r,s)=>{"use strict";s.d(r,{P:()=>t,g:()=>a});let t=(e,r)=>{e.current&&e.current.show({severity:r.severity,summary:r.summary,detail:r.detail,life:r.life||1e3})},a={success:{default:"Succ\xe8s",create:"Cr\xe9ation r\xe9ussie",update:"Mise \xe0 jour r\xe9ussie",delete:"Suppression r\xe9ussie",accept:"Acceptation r\xe9ussie",reject:"Rejet r\xe9ussi"},error:{default:"Erreur",create:"Erreur lors de la cr\xe9ation",update:"Erreur lors de la mise \xe0 jour",delete:"Erreur lors de la suppression",auth:"Vous devez \xeatre connect\xe9",accept:"Erreur lors de l'acceptation",reject:"Erreur lors du rejet"},warning:{default:"Attention"},info:{default:"Information",reject:"Rejet effectu\xe9"}}},4064:(e,r,s)=>{"use strict";s.d(r,{d:()=>u,t:()=>o});var t=s(5155),a=s(2115),i=s(8574),l=s(3769);let c=(0,a.createContext)(void 0),o=e=>{let{children:r}=e,s=(0,a.useRef)(null);return(0,t.jsxs)(c.Provider,{value:{showToast:e=>{(0,l.P)(s,e)}},children:[r,(0,t.jsx)(i.y,{ref:s})]})},u=()=>{let e=(0,a.useContext)(c);if(void 0===e)throw Error("useToast must be used within a ToastProvider");return e}},4687:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>h});var t=s(5155),a=s(2115);s(2737);var i=s(29),l=s(5973),c=s(9708);let o=async(e,r)=>{try{let s=(0,c.H9)(l.db,"posts",e);await (0,c.mZ)(s,{likes:(0,c.hq)(r)})}catch(e){console.error("Error liking post: ",e)}},u=async(e,r)=>{try{let s=(0,c.H9)(l.db,"posts",e);await (0,c.mZ)(s,{likes:(0,c.C3)(r)})}catch(e){console.error("Error unliking post: ",e)}};var n=s(2718),d=s(6596),p=s(4547),m=s(3769),y=s(4064);let h=e=>{let{postId:r,title:s,content:c,createdAt:h,fromRequest:v=!1,visible:f=!0,userName:b}=e,{user:g,role:j}=(0,n.A)(),[w,x]=(0,a.useState)([]),[k,E]=(0,a.useState)(!1),[N,P]=(0,a.useState)(f),_=null==g?void 0:g.uid,{showToast:C}=(0,y.d)();(0,a.useEffect)(()=>{let e=(0,d.aQ)((0,d.H9)(l.db,"posts",r),e=>{if(e.exists()){let r=e.data();x(r.likes||[]),P(!1!==r.visible)}});return()=>e()},[r]);let S=!!_&&w.includes(_),H=async()=>{if(!_)return void C({severity:"warn",summary:m.g.warning.default,detail:m.g.error.auth});E(!0);try{S?await u(r,_):await o(r,_)}catch(e){C({severity:"error",summary:m.g.error.default,detail:"Une erreur est survenue lors de l'action."})}E(!1)},q=async()=>{E(!0);try{let e=(0,d.H9)(l.db,"posts",r);await (0,d.mZ)(e,{visible:!N}),P(!N),C({severity:"success",summary:m.g.success.default,detail:"Le post est maintenant ".concat(N?"masqu\xe9":"visible",".")})}catch(e){C({severity:"error",summary:m.g.error.default,detail:"Erreur lors du changement de visibilit\xe9."})}E(!1)},A=async()=>{E(!0);try{let e=(0,d.H9)(l.db,"posts",r);await (0,d.kd)(e),C({severity:"success",summary:m.g.success.default,detail:m.g.success.delete})}catch(e){C({severity:"error",summary:m.g.error.default,detail:m.g.error.delete})}E(!1)};return(0,t.jsxs)("div",{className:"Post ".concat(v?"Post_request":""," ").concat(N?"":"Post-hidden"),children:[(0,t.jsx)("h1",{children:s}),(0,t.jsx)("p",{style:{whiteSpace:"pre-wrap"},children:c}),(0,t.jsxs)("section",{className:"Section_buttons",children:[!v&&(0,t.jsx)(i.$,{className:"Post_likeButton",onClick:H,disabled:k,severity:S?"danger":"secondary",icon:S?"pi pi-heart-fill":"pi pi-heart",label:w.length.toString()}),"admin"===j&&!v&&(0,t.jsxs)("div",{className:"Post_admin_actions",children:[(0,t.jsx)(i.$,{className:"Post_visibilityButton",label:N?"Masquer":"Afficher",icon:N?"pi pi-eye-slash":"pi pi-eye",onClick:q,disabled:k,severity:N?"warning":"success"}),(0,t.jsx)(i.$,{className:"Post_deleteButton",label:"Supprimer",icon:"pi pi-trash",onClick:()=>{(0,p.Z)({message:"\xcates-vous s\xfbr de vouloir supprimer ce post ?",header:"Confirmation de suppression",icon:"pi pi-exclamation-triangle",acceptLabel:"Oui",rejectLabel:"Non",accept:A})},disabled:k,severity:"danger"}),(0,t.jsxs)("span",{className:"post-date",children:[h," "]}),(0,t.jsx)("span",{className:"post-user",children:b})]})]})]})}}}]);