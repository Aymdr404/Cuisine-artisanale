(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5199],{3769:(e,t,r)=>{"use strict";r.d(t,{P:()=>s,g:()=>a});let s=(e,t)=>{e.current&&e.current.show({severity:t.severity,summary:t.summary,detail:t.detail,life:t.life||1e3})},a={success:{default:"Succ\xe8s",create:"Cr\xe9ation r\xe9ussie",update:"Mise \xe0 jour r\xe9ussie",delete:"Suppression r\xe9ussie",accept:"Acceptation r\xe9ussie",reject:"Rejet r\xe9ussi"},error:{default:"Erreur",create:"Erreur lors de la cr\xe9ation",update:"Erreur lors de la mise \xe0 jour",delete:"Erreur lors de la suppression",auth:"Vous devez \xeatre connect\xe9",accept:"Erreur lors de l'acceptation",reject:"Erreur lors du rejet"},warning:{default:"Attention"},info:{default:"Information",reject:"Rejet effectu\xe9"}}},4064:(e,t,r)=>{"use strict";r.d(t,{d:()=>n,t:()=>o});var s=r(5155),a=r(2115),i=r(8574),c=r(3769);let l=(0,a.createContext)(void 0),o=e=>{let{children:t}=e,r=(0,a.useRef)(null);return(0,s.jsxs)(l.Provider,{value:{showToast:e=>{(0,c.P)(r,e)}},children:[t,(0,s.jsx)(i.y,{ref:r})]})},n=()=>{let e=(0,a.useContext)(l);if(void 0===e)throw Error("useToast must be used within a ToastProvider");return e}},5700:(e,t,r)=>{Promise.resolve().then(r.bind(r,9006))},5973:(e,t,r)=>{"use strict";r.d(t,{I:()=>d,db:()=>n,j:()=>o});var s=r(2078),a=r(9708),i=r(8134),c=r(3885);let l=(0,s.Wp)({apiKey:"AIzaSyCRqPaeQ_8kRByuf8l9_Fkcbmdgy_0aWI4",authDomain:"recettes-cuisine-a1bf2.firebaseapp.com",projectId:"recettes-cuisine-a1bf2",storageBucket:"recettes-cuisine-a1bf2.firebasestorage.app",messagingSenderId:"854150054780",appId:"1:854150054780:web:e3866880aea3e01d5c1af9",measurementId:"G-1J6YNX5LZM"}),o=(0,c.xI)(l),n=(0,a.aU)(l),d=(0,i.c7)(l)},8795:()=>{},9006:(e,t,r)=>{"use strict";r.d(t,{default:()=>x});var s=r(5155),a=r(2115);r(8795);var i=r(5973),c=r(6596),l=r(6743),o=r(29),n=r(8574),d=r(1695),p=r(4547),u=r(4340),m=r(6218),h=r(1771),j=r(3026),v=r(3769),g=r(4064);let x=()=>{let[e,t]=(0,a.useState)([]),[r,x]=(0,a.useState)(!0),[f,b]=(0,a.useState)(""),[y,N]=(0,a.useState)("createdAt"),[w,C]=(0,a.useState)("desc"),k=(0,a.useRef)(null),{showToast:E}=(0,g.d)();(0,a.useEffect)(()=>{let e=(()=>{try{x(!0);let e=(0,c.P)((0,c.rJ)(i.db,"recipesRequest"),(0,c.My)("createdAt","desc"));return(0,c.aQ)(e,e=>{let r=e.docs.map(e=>{var t;let r=e.data();return{...r,recetteId:e.id,createdAt:null==(t=r.createdAt)?void 0:t.toDate(),images:r.images||[],status:r.status||"pending"}});t(r),x(!1)},e=>{console.error("Error getting recettes:",e),E({severity:"error",summary:v.g.error.default,detail:"Impossible de charger les recettes"}),x(!1)})}catch(e){return console.error("Error in handleFetchRecettes:",e),x(!1),()=>{}}})();return()=>e()},[]);let A=async e=>{try{let t=(0,c.H9)(i.db,"recipesRequest",e.recetteId),r=await (0,c.x7)(t);if(!r.exists())return void E({severity:"error",summary:v.g.error.default,detail:"Recette introuvable"});let s=r.data();await (0,c.gS)((0,c.rJ)(i.db,"recipes"),{...s,createdAt:new Date,likes:[]}),await (0,c.kd)(t),E({severity:"success",summary:v.g.success.default,detail:"La recette a \xe9t\xe9 accept\xe9e et publi\xe9e"})}catch(e){console.error("Error accepting recipe:",e),E({severity:"error",summary:v.g.error.default,detail:"Erreur lors de l'acceptation de la recette"})}},R=async e=>{try{await (0,c.kd)((0,c.H9)(i.db,"recipesRequest",e)),E({severity:"info",summary:v.g.info.default,detail:"La recette a \xe9t\xe9 rejet\xe9e avec succ\xe8s"})}catch(e){console.error("Error rejecting recipe:",e),E({severity:"error",summary:v.g.error.default,detail:"Erreur lors du rejet de la recette"})}},L=async e=>{try{await (0,c.kd)((0,c.H9)(i.db,"recipesRequest",e)),E({severity:"success",summary:v.g.success.default,detail:v.g.success.delete})}catch(e){console.error("Erreur de suppression:",e),E({severity:"error",summary:v.g.error.default,detail:v.g.error.delete})}},P=e=>{if(!e)return"Non sp\xe9cifi\xe9";let t=Math.floor(e/60),r=e%60;return"".concat(t>0?"".concat(t,"h "):"").concat(r>0?"".concat(r,"min"):"")};return r?(0,s.jsxs)("div",{className:"loading-container",children:[(0,s.jsx)(d.p,{}),(0,s.jsx)("p",{children:"Chargement des recettes..."})]}):(0,s.jsxs)("div",{className:"recipes-admin",children:[(0,s.jsx)(n.y,{ref:k}),(0,s.jsx)(p.T,{}),(0,s.jsx)(l.U$,{value:e.filter(e=>e.title.toLowerCase().includes(f.toLowerCase())||e.type.toLowerCase().includes(f.toLowerCase())||e.createdBy.toLowerCase().includes(f.toLowerCase())),layout:"grid",header:(0,s.jsxs)("div",{className:"recipes-header",children:[(0,s.jsx)("h2",{children:"Gestion des Recettes"}),(0,s.jsxs)("div",{className:"recipes-header-actions",children:[(0,s.jsxs)("span",{className:"p-input-icon-left",children:[(0,s.jsx)("i",{className:"pi pi-search"}),(0,s.jsx)(u.S,{value:f,onChange:e=>b(e.target.value),placeholder:"Rechercher..."})]}),(0,s.jsx)(m.m,{value:"".concat(y,":").concat(w),options:[{label:"Plus r\xe9cent",value:"createdAt:desc"},{label:"Plus ancien",value:"createdAt:asc"},{label:"Titre A-Z",value:"title:asc"},{label:"Titre Z-A",value:"title:desc"}],onChange:e=>{let[t,r]=e.value.split(":");N(t),C(r)},className:"sort-dropdown"})]})]}),itemTemplate:e=>(0,s.jsxs)("div",{className:"recipe-card-admin",children:[(0,s.jsxs)("div",{className:"recipe-card-header",children:[(0,s.jsxs)("div",{className:"recipe-title-section",children:[(0,s.jsx)("h3",{children:e.title}),(0,s.jsx)(h.v,{value:e.type,severity:"info",className:"recipe-type-tag"})]}),(0,s.jsx)("span",{className:"recipe-status",style:{backgroundColor:{pending:"var(--warning-color)",approved:"var(--success-color)",rejected:"var(--danger-color)"}[e.status||"pending"]},children:"pending"===e.status?"En attente":"approved"===e.status?"Approuv\xe9e":"Rejet\xe9e"})]}),(0,s.jsxs)("div",{className:"recipe-card-content",children:[e.images&&e.images.length>0&&(0,s.jsxs)("div",{className:"recipe-images",children:[(0,s.jsx)(j._,{src:e.images[0],alt:e.title,width:"100",preview:!0}),e.images.length>1&&(0,s.jsxs)("span",{className:"image-count",children:["+",e.images.length-1]})]}),(0,s.jsx)("div",{className:"recipe-details",children:(0,s.jsxs)("div",{className:"recipe-metadata",children:[e.preparationTime&&(0,s.jsxs)("span",{className:"metadata-item",children:[(0,s.jsx)("i",{className:"pi pi-clock"})," Pr\xe9paration: ",P(e.preparationTime)]}),e.cookingTime&&(0,s.jsxs)("span",{className:"metadata-item",children:[(0,s.jsx)("i",{className:"pi pi-stopwatch"})," Cuisson: ",P(e.cookingTime)]}),e.recipeParts&&e.recipeParts.length>0&&(0,s.jsxs)("span",{className:"metadata-item",children:[(0,s.jsx)("i",{className:"pi pi-list"})," ",e.recipeParts.length," parties"]})]})}),e.recipeParts&&e.recipeParts.length>0&&(0,s.jsx)("div",{className:"recipe-parts",children:e.recipeParts.map((e,t)=>(0,s.jsxs)("div",{className:"recipe-part",children:[(0,s.jsx)("h4",{children:e.title}),(0,s.jsx)("p",{children:e.steps.join("\n")}),(0,s.jsx)("ul",{children:e.ingredients.map((e,t)=>(0,s.jsxs)("li",{children:[e.name," (",e.quantity," ",e.unit,")"]},t))})]},t))})]}),(0,s.jsxs)("div",{className:"recipe-card-footer",children:[(0,s.jsxs)("div",{className:"recipe-info",children:[(0,s.jsxs)("span",{className:"recipe-author",children:[(0,s.jsx)("i",{className:"pi pi-user"})," ",e.createdBy]}),e.createdAt&&(0,s.jsxs)("span",{className:"recipe-date",children:[(0,s.jsx)("i",{className:"pi pi-calendar"})," ",e.createdAt.toLocaleDateString("fr-FR")]})]}),(0,s.jsxs)("div",{className:"recipe-actions",children:[(0,s.jsx)(o.$,{icon:"pi pi-check",className:"p-button-rounded p-button-success p-button-text",onClick:()=>(e=>{(0,p.Z)({message:'\xcates-vous s\xfbr de vouloir accepter et publier la recette "'.concat(e.title,'" ?'),header:"Confirmation de publication",icon:"pi pi-check-circle",acceptLabel:"Oui",rejectLabel:"Non",accept:()=>A(e)})})(e),tooltip:"Approuver",tooltipOptions:{position:"bottom"},disabled:"approved"===e.status}),(0,s.jsx)(o.$,{icon:"pi pi-times",className:"p-button-rounded p-button-warning p-button-text",onClick:()=>(e=>{(0,p.Z)({message:'\xcates-vous s\xfbr de vouloir rejeter la recette "'.concat(e.title,'" ?'),header:"Confirmation de rejet",icon:"pi pi-exclamation-triangle",acceptLabel:"Oui",rejectLabel:"Non",accept:()=>R(e.recetteId)})})(e),tooltip:"Rejeter",tooltipOptions:{position:"bottom"},disabled:"rejected"===e.status}),(0,s.jsx)(o.$,{icon:"pi pi-trash",className:"p-button-rounded p-button-danger p-button-text",onClick:()=>{var t,r;return t=e.recetteId,r=e.title,void(0,p.Z)({message:'\xcates-vous s\xfbr de vouloir supprimer la recette "'.concat(r,'" ?'),header:"Confirmation de suppression",icon:"pi pi-exclamation-triangle",acceptLabel:"Oui",rejectLabel:"Non",accept:()=>L(t)})},tooltip:"Supprimer",tooltipOptions:{position:"bottom"}})]})]})]}),paginator:!0,rows:6,emptyMessage:"Aucune recette trouv\xe9e"})]})}}},e=>{e.O(0,[4580,2992,9895,4797,1055,8296,29,6946,8574,3640,1056,2165,2571,1473,1148,8441,1255,7358],()=>e(e.s=5700)),_N_E=e.O()}]);