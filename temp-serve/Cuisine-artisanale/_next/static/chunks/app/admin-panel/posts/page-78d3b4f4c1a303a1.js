(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1069],{3769:(e,t,r)=>{"use strict";r.d(t,{P:()=>s,g:()=>a});let s=(e,t)=>{e.current&&e.current.show({severity:t.severity,summary:t.summary,detail:t.detail,life:t.life||1e3})},a={success:{default:"Succ\xe8s",create:"Cr\xe9ation r\xe9ussie",update:"Mise \xe0 jour r\xe9ussie",delete:"Suppression r\xe9ussie",accept:"Acceptation r\xe9ussie",reject:"Rejet r\xe9ussi"},error:{default:"Erreur",create:"Erreur lors de la cr\xe9ation",update:"Erreur lors de la mise \xe0 jour",delete:"Erreur lors de la suppression",auth:"Vous devez \xeatre connect\xe9",accept:"Erreur lors de l'acceptation",reject:"Erreur lors du rejet"},warning:{default:"Attention"},info:{default:"Information",reject:"Rejet effectu\xe9"}}},4064:(e,t,r)=>{"use strict";r.d(t,{d:()=>l,t:()=>n});var s=r(5155),a=r(2115),o=r(8574),c=r(3769);let i=(0,a.createContext)(void 0),n=e=>{let{children:t}=e,r=(0,a.useRef)(null);return(0,s.jsxs)(i.Provider,{value:{showToast:e=>{(0,c.P)(r,e)}},children:[t,(0,s.jsx)(o.y,{ref:r})]})},l=()=>{let e=(0,a.useContext)(i);if(void 0===e)throw Error("useToast must be used within a ToastProvider");return e}},5012:(e,t,r)=>{"use strict";r.d(t,{default:()=>j});var s=r(5155),a=r(2115);r(9217);var o=r(9708),c=r(5973),i=r(6743),n=r(29),l=r(8574),d=r(1695),u=r(4547),p=r(4340),m=r(6218),h=r(3769),v=r(4064);let j=()=>{let[e,t]=(0,a.useState)([]),[r,j]=(0,a.useState)(!0),[g,f]=(0,a.useState)(""),[b,x]=(0,a.useState)("createdAt"),[y,N]=(0,a.useState)("desc"),w=(0,a.useRef)(null),{showToast:C}=(0,v.d)();(0,a.useEffect)(()=>{let e=(()=>{try{j(!0);let e=(0,o.P)((0,o.rJ)(c.db,"postsRequest"),(0,o.My)("createdAt","desc"));return(0,o.aQ)(e,e=>{let r=e.docs.map(e=>{var t;let r=e.data();return{id:e.id,title:r.title,content:r.content,createdAt:null==(t=r.createdAt)?void 0:t.toDate(),author:r.author,status:r.status}});t(r),j(!1)},e=>{console.error("Error getting posts:",e),C({severity:"error",summary:h.g.error.default,detail:"Impossible de charger les posts"}),j(!1)})}catch(e){return console.error("Error in handleFetchPosts:",e),j(!1),()=>{}}})();return()=>e()},[]);let k=async e=>{try{await (0,o.gS)((0,o.rJ)(c.db,"posts"),{title:e.title,content:e.content,createdAt:new Date,likes:[]}),await (0,o.kd)((0,o.H9)(c.db,"postsRequest",e.id)),C({severity:"success",summary:h.g.success.default,detail:h.g.success.accept})}catch(e){console.error("Error accepting post:",e),C({severity:"error",summary:h.g.error.default,detail:h.g.error.accept})}},E=async e=>{try{await (0,o.kd)((0,o.H9)(c.db,"postsRequest",e)),C({severity:"info",summary:h.g.info.default,detail:h.g.info.reject})}catch(e){console.error("Error rejecting post:",e),C({severity:"error",summary:h.g.error.default,detail:h.g.error.reject})}},A=async e=>{try{await (0,o.kd)((0,o.H9)(c.db,"posts",e)),C({severity:"success",summary:h.g.success.default,detail:h.g.success.delete})}catch(e){console.error("Erreur de suppression:",e),C({severity:"error",summary:h.g.error.default,detail:h.g.error.delete})}};return r?(0,s.jsxs)("div",{className:"loading-container",children:[(0,s.jsx)(d.p,{}),(0,s.jsx)("p",{children:"Chargement des posts..."})]}):(0,s.jsxs)("div",{className:"posts-admin",children:[(0,s.jsx)(l.y,{ref:w}),(0,s.jsx)(u.T,{}),(0,s.jsx)(i.U$,{value:e.filter(e=>{var t;return e.title.toLowerCase().includes(g.toLowerCase())||e.content.toLowerCase().includes(g.toLowerCase())||(null==(t=e.author)?void 0:t.toLowerCase().includes(g.toLowerCase()))}),layout:"grid",header:(0,s.jsxs)("div",{className:"posts-header",children:[(0,s.jsx)("h2",{children:"Gestion des Posts"}),(0,s.jsxs)("div",{className:"posts-header-actions",children:[(0,s.jsxs)("span",{className:"p-input-icon-left",children:[(0,s.jsx)("i",{className:"pi pi-search"}),(0,s.jsx)(p.S,{value:g,onChange:e=>f(e.target.value),placeholder:"Rechercher..."})]}),(0,s.jsx)(m.m,{value:"".concat(b,":").concat(y),options:[{label:"Plus r\xe9cent",value:"createdAt:desc"},{label:"Plus ancien",value:"createdAt:asc"},{label:"Titre A-Z",value:"title:asc"},{label:"Titre Z-A",value:"title:desc"}],onChange:e=>{let[t,r]=e.value.split(":");x(t),N(r)},className:"sort-dropdown"})]})]}),itemTemplate:e=>(0,s.jsxs)("div",{className:"post-card",children:[(0,s.jsxs)("div",{className:"post-card-header",children:[(0,s.jsx)("h3",{children:e.title}),(0,s.jsx)("span",{className:"post-status",style:{backgroundColor:{pending:"var(--warning-color)",approved:"var(--success-color)",rejected:"var(--danger-color)"}[e.status||"pending"]},children:"pending"===e.status?"En attente":"approved"===e.status?"Approuv\xe9":"Rejet\xe9"})]}),(0,s.jsx)("div",{className:"post-card-content",children:(0,s.jsx)("p",{children:e.content})}),(0,s.jsxs)("div",{className:"post-card-footer",children:[(0,s.jsxs)("div",{className:"post-info",children:[(0,s.jsxs)("span",{className:"post-author",children:[(0,s.jsx)("i",{className:"pi pi-user"})," ",e.author]}),(0,s.jsxs)("span",{className:"post-date",children:[(0,s.jsx)("i",{className:"pi pi-calendar"})," ",e.createdAt.toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),(0,s.jsxs)("div",{className:"post-actions",children:[(0,s.jsx)(n.$,{icon:"pi pi-check",className:"p-button-rounded p-button-success p-button-text",onClick:()=>(e=>{(0,u.Z)({message:'\xcates-vous s\xfbr de vouloir accepter et publier le post "'.concat(e.title,'" ?'),header:"Confirmation de publication",icon:"pi pi-check-circle",acceptLabel:"Oui",rejectLabel:"Non",accept:()=>k(e)})})(e),tooltip:"Approuver"}),(0,s.jsx)(n.$,{icon:"pi pi-times",className:"p-button-rounded p-button-warning p-button-text",onClick:()=>(e=>{(0,u.Z)({message:'\xcates-vous s\xfbr de vouloir rejeter le post "'.concat(e.title,'" ?'),header:"Confirmation de rejet",icon:"pi pi-exclamation-triangle",acceptLabel:"Oui",rejectLabel:"Non",accept:()=>E(e.id)})})(e),tooltip:"Rejeter"}),(0,s.jsx)(n.$,{icon:"pi pi-trash",className:"p-button-rounded p-button-danger p-button-text",onClick:()=>{var t,r;return t=e.id,r=e.title,void(0,u.Z)({message:'\xcates-vous s\xfbr de vouloir supprimer le post "'.concat(r,'" ?'),header:"Confirmation de suppression",icon:"pi pi-exclamation-triangle",acceptLabel:"Oui",rejectLabel:"Non",accept:()=>A(t)})},tooltip:"Supprimer"})]})]})]}),paginator:!0,rows:9,emptyMessage:"Aucun post trouv\xe9"})]})}},5973:(e,t,r)=>{"use strict";r.d(t,{I:()=>d,db:()=>l,j:()=>n});var s=r(2078),a=r(9708),o=r(8134),c=r(3885);let i=(0,s.Wp)({apiKey:"AIzaSyCRqPaeQ_8kRByuf8l9_Fkcbmdgy_0aWI4",authDomain:"recettes-cuisine-a1bf2.firebaseapp.com",projectId:"recettes-cuisine-a1bf2",storageBucket:"recettes-cuisine-a1bf2.firebasestorage.app",messagingSenderId:"854150054780",appId:"1:854150054780:web:e3866880aea3e01d5c1af9",measurementId:"G-1J6YNX5LZM"}),n=(0,c.xI)(i),l=(0,a.aU)(i),d=(0,o.c7)(i)},8740:(e,t,r)=>{Promise.resolve().then(r.bind(r,5012))},9217:()=>{}},e=>{e.O(0,[8514,2992,9895,4797,1055,8296,29,6946,8574,3640,1056,2165,2571,1473,8441,1255,7358],()=>e(e.s=8740)),_N_E=e.O()}]);